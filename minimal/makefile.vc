# DynamicMail Minimal Plugin Makefile for Win32

# Change these as needed
DWLIBDIR=\netlabs\dwindows\lib
DWINCDIR=\netlabs\dwindows

CC = cl
CFLAGS = -c -G5 -GD -Zp1 -DWIN32 -D__WIN32__ -DMSVC -DBUILD_DLL -I$(DWINCDIR) -I. -I..
CFLAGS_DEBUG = -Zi
CFLAGS_COMPILE = -MTd
LIBS = $(DWLIBDIR)\dw.lib $(DWLIBDIR)\dwcompat.lib
RES = 
LINKFLAGS = -machine:i386 -debug:full -debugtype:cv
DLLLINKFLAGS = -dll
LINK = link
DEFFILE = minimalw.def

OBJS =	minimal.obj

all: minimal.dll

clean:
	-erase *.dll
        -erase *.exe
        -erase *.opt
        -erase *.lib
        -erase *.obj
        -erase *.map
        -erase *.pdb
        -erase *.ilk
        -erase *.exp
        -erase *~
        
minimal.dll: $(OBJS) $(DEFFILE)
	$(LINK) @<<
-out:$(@) -def:$(DEFFILE)
$(LINKFLAGS) $(DLLLINKFLAGS)
$(OBJS) $(RES)
$(LIBS)
<<
        copy minimal.dll ..

.c.obj:
	$(CC) $(CFLAGS) $(CFLAGS_DEBUG) $(CFLAGS_COMPILE) $*.c
